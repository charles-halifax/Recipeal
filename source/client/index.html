<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recipe App</title>

    <!-- Web Components -->
    <script src="assets/components/RecipeCard.js" type="module"></script>
    <!-- <script src="assets/components/RecipeExpand.js" type="module"></script> -->

    <!-- Service Worker
  <script src="sw.js" type="module"></script> -->

    <!-- Router -->
    <script src="assets/scripts/Router.js" type="module"></script>

    <!-- Main Stylesheet & Scripts -->
    <link rel="stylesheet" href="assets/styles/main.css" />
    <script src="assets/scripts/main.js" type="module"></script>

    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />

    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
  </head>

  <body>
    <main>
      <section class="section--recipe-cards shown">
        <nav class="navbar navbar-light bg-dark">
          <span class="navbar-brand mb-0 h1 text-white">Navbar</span>
          <div class="navbar-nav mx-auto d-flex flex-row">
            <button
              class="nav-item btn btn-light mr-3"
              onclick="changeView(event)"
            >
              My Recipes
            </button>
            <button class="nav-item btn btn-dark" onclick="changeView(event)">
              Explore
            </button>
          </div>
        </nav>

        <section class="recipe-cards--wrapper shown">
          My recipes
          <!-- Recipes Added Here -->
        </section>

        <section class="explore container-fluid">
          <div class="row visible-xs-*">
            <div class="col xs0"></div>
            <div class="col xs1"></div>
          </div>
          <div class="row visible-sm-*">
            <div class="col sm0"></div>
            <div class="col sm1"></div>
            <div class="col sm2"></div>
          </div>
          <div class="row hidden-xs hidden-sm" style="height: 300px">
            <div class="col lg0"></div>
            <div class="col lg1"></div>
            <div class="col lg2"></div>
            <div class="col lg3"></div>
          </div>
        </section>
      </section>
      <section class="section--recipe-explore"></section>
    </main>
    <script>
      function changeView(e) {
        var myRecipes = document.querySelector(".recipe-cards--wrapper");
        var explore = document.querySelector(".explore");

        if (e.target.innerText === "My Recipes") {
          myRecipes.classList.add("shown");
          explore.classList.remove("shown");
          [...document.querySelectorAll(".col")].forEach((element) => {
            element.innerHTML = "";
          });
        }
        if (e.target.innerText === "Explore") {
          myRecipes.classList.remove("shown");
          explore.classList.add("shown");
          fetchApiRecipes();
        }
        switchHighlight(e.target);
      }
      function switchHighlight(target) {
        var nav = document.querySelector(".navbar-nav");
        var buttons = nav.getElementsByTagName("*");
        var e;
        for (var i = 0; i < buttons.length; i++) {
          e = buttons[i];
          if (e === target) {
            e.classList.remove("btn-dark");
            e.classList.add("btn-white");
          } else {
            e.classList.add("btn-dark");
            e.classList.remove("btn-white");
          }
        }
      }
      async function fetchApiRecipes() {
        const API_KEY = "b24485ab3d4a47f696151e7134433592";
        const response = await fetch(
          `https://api.spoonacular.com/recipes/random?number=5&apiKey=${API_KEY}`
        );

        // Storing data in form of JSON
        var data = await response.json();
        data.recipes.forEach((element, i) => {
          console.log(element);
          const recipeData = {
            image: element.image,
            title: element.title,
            description: element.summary,
          };
          const recipeCard = document.createElement("recipe-card");
          recipeCard.data = recipeData;

          document.querySelector(`.xs${i % 2}`).appendChild(recipeCard);
          document.querySelector(`.sm${i % 3}`).appendChild(recipeCard);
          document.querySelector(`.lg${i % 4}`).appendChild(recipeCard);
          console.log(
            String(`.xs${i % 2}`),
            document.querySelector(`.xs${i % 2}`),
            document.querySelector(`.explore`)
          );
        });
      }
    </script>
  </body>
</html>
